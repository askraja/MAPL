rules:

  - rule_id: 0
    sender: "A.my_namespace"
    receiver: "B.my_namespace"
    protocol: http
    resource:
      resourceType: httpPath
      resourceName: "/*"
    operation: GET
    decision: allow

  - rule_id: 1
    sender: "*"
    receiver: "serviceX"
    resource:      resourceProtocol: HTTP
      resourceType: httpPath
      resourceName: "/*"
    operation: GET
    DNFconditions:
      - ANDConditions:
        - attribute: "senderLabel"
          method: EQ
          value: "a"
        - attribute: "payloadSize"
          method: LE
          value: "4096"
    decision: allow

  - rule_id: 2
    sender: "*"
    receiver: "serviceX"
    resource:      resourceProtocol: HTTP
      resourceType: httpPath
      resourceName: "/*"
    operation: GET
    DNFconditions:
      - ANDConditions:
        - attribute: "senderLabel"
          method: EQ
          value: "c"
        - attribute: "senderLabel"
          method: EQ
          value: "e"
    decision: allow

  - rule_id: 3
    sender: "serviceY"
    receiver: "*"
    resource:      resourceProtocol: HTTP
      resourceType: httpPath
      resourceName: "/*"
    operation: GET
    DNFconditions:
      - ANDConditions:
        - attribute: "receiverLabel"
          method: EQ
          value: "c"
    decision: allow

  - rule_id: 4
    sender: "*"
    receiver: "*"
    resource:      resourceProtocol: HTTP
      resourceType: httpPath
      resourceName: "/books/*"
    operation: WRITE
    DNFconditions:
      - ANDConditions:
        - attribute: "receiverLabel"
          method: EQ
          value: "c"
    decision: allow

  - rule_id: 5
    sender: "*"
    receiver: "*"
    resource:      resourceProtocol: HTTP
      resourceType: httpPath
      resourceName: "/books/*"
    operation: POST
    DNFconditions:
      - ANDConditions:
        - attribute: "receiverLabel"
          method: EQ
          value: "c"
        - attribute: "senderLabel"
          method: EQ
          value: "A"
    decision: allow

  - rule_id: 6
    sender: "*"
    receiver: "*"
    resource:      resourceProtocol: HTTP
      resourceType: httpPath
      resourceName: "/books/*"
    operation: POST
    DNFconditions:
      - ANDConditions:
        - attribute: "receiverLabel"
          method: EQ
          value: "C"
        - attribute: "senderLabel"
          method: EQ
          value: "A"
      - ANDConditions:
        - attribute: "receiverLabel"
          method: EQ
          value: "d"
        - attribute: "senderLabel"
          method: EQ
          value: "e"
      - ANDConditions:
        - attribute: "receiverLabel"
          method: EQ
          value: "d"
        - attribute: "senderLabel"
          method: EQ
          value: "abc"
    decision: allow

  - rule_id: 7
    sender: "*"
    receiver: "serviceX"
    resource:      resourceProtocol: HTTP
      resourceType: httpPath
      resourceName: "/books/*"
    operation: WRITE
    DNFconditions:
      - ANDConditions:
        - attribute: "senderLabel"
          method: EQ
          value: "true"
    decision: allow

  - rule_id: 8
    sender: "*"
    receiver: "serviceY"
    resource:      resourceProtocol: HTTP
      resourceType: httpPath
      resourceName: "/books/*"
    operation: WRITE
    DNFconditions:
      - ANDConditions:
        - attribute: "senderLabel"
          method: EQ
          value: "true"
    decision: allow
