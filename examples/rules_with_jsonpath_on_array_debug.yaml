rules:
  - rule_id: 0
    sender:
      senderName: "A.my_namespace"
      senderType: "workload"
    receiver:
      receiverName: "B.my_namespace"
      receiverType: "workload"
    protocol: "*"
    resource:
      resourceType: "*"
      resourceName: "*"
    operation: "*"
    DNFconditions:
      - ANDconditions:
          - attribute: jsonpath:$.spec.template.spec.containers[:].resources.limits.cpu
            method: LT
            value: 2

    decision: block

  - rule_id: 1
    sender:
      senderName: "A.my_namespace"
      senderType: "workload"
    receiver:
      receiverName: "B.my_namespace"
      receiverType: "workload"
    protocol: "*"
    resource:
      resourceType: "*"
      resourceName: "*"
    operation: "*"
    DNFconditions:
      - ANDconditions:
          - attribute: jsonpath:$.metadata.labels.foo
            method: LT
            value: 4
    decision: block

  - rule_id: 2
    sender:
      senderName: "A.my_namespace"
      senderType: "workload"
    receiver:
      receiverName: "B.my_namespace"
      receiverType: "workload"
    protocol: "*"
    resource:
      resourceType: "*"
      resourceName: "*"
    operation: "*"
    DNFconditions:
      - ANDconditions:
        - attribute: jsonpath:$.spec.template.spec.containers[:].resources.requests.memory
          method: LT
          value: 7
        - attribute: jsonpath:$.metadata.labels.foo
          method: LE
          value: 9
    decision: block
  - rule_id: 3
    sender:
      senderName: "A.my_namespace"
      senderType: "workload"
    receiver:
      receiverName: "B.my_namespace"
      receiverType: "workload"
    protocol: "*"
    resource:
      resourceType: "*"
      resourceName: "*"
    operation: "*"
    DNFconditions:
      - ANDconditions:
          - attribute: jsonpath:$.spec.template.spec.containers[:].resources.requests.memory
            method: LT
            value: 7
          - attribute: jsonpath:$.metadata.labels.foo
            method: LE
            value: 9
